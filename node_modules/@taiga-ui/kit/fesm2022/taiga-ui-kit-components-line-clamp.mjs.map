{"version":3,"file":"taiga-ui-kit-components-line-clamp.mjs","sources":["../../../projects/kit/components/line-clamp/line-clamp.options.ts","../../../projects/kit/components/line-clamp/line-clamp-box.component.ts","../../../projects/kit/components/line-clamp/line-clamp-position.directive.ts","../../../projects/kit/components/line-clamp/line-clamp.component.ts","../../../projects/kit/components/line-clamp/line-clamp.template.html","../../../projects/kit/components/line-clamp/taiga-ui-kit-components-line-clamp.ts"],"sourcesContent":["import type {Provider} from '@angular/core';\nimport {tuiCreateToken, tuiProvideOptions} from '@taiga-ui/cdk/utils/miscellaneous';\n\nexport interface TuiLineClampOptions {\n    readonly showHint: boolean;\n}\n\nexport const TUI_LINE_CLAMP_DEFAULT_OPTIONS: TuiLineClampOptions = {\n    showHint: true,\n};\n\n/**\n * Default parameters for LineClamp component\n */\nexport const TUI_LINE_CLAMP_OPTIONS = tuiCreateToken(TUI_LINE_CLAMP_DEFAULT_OPTIONS);\n\nexport function tuiLineClampOptionsProvider(\n    options: Partial<TuiLineClampOptions>,\n): Provider {\n    return tuiProvideOptions(\n        TUI_LINE_CLAMP_OPTIONS,\n        options,\n        TUI_LINE_CLAMP_DEFAULT_OPTIONS,\n    );\n}\n","import {ChangeDetectionStrategy, Component} from '@angular/core';\nimport {tuiFadeIn} from '@taiga-ui/core/animations';\nimport {TUI_HINT_PROVIDERS, TuiHintComponent} from '@taiga-ui/core/directives/hint';\nimport {PolymorpheusOutlet, PolymorpheusTemplate} from '@taiga-ui/polymorpheus';\n\n@Component({\n    standalone: true,\n    imports: [PolymorpheusOutlet, PolymorpheusTemplate],\n    template: `\n        <ng-container *polymorpheusOutlet=\"content() as text\">{{ text }}</ng-container>\n    `,\n    styleUrls: ['./line-clamp-box.style.less'],\n    changeDetection: ChangeDetectionStrategy.OnPush,\n    providers: TUI_HINT_PROVIDERS,\n    animations: [tuiFadeIn],\n    host: {\n        '[style.min-width.px]': 'width',\n    },\n})\nexport class TuiLineClampBox extends TuiHintComponent {\n    protected get width(): number {\n        return this.accessor.getClientRect().width;\n    }\n}\n","import {Directive, inject} from '@angular/core';\nimport type {TuiRectAccessor} from '@taiga-ui/core/classes';\nimport {tuiAsPositionAccessor, TuiPositionAccessor} from '@taiga-ui/core/classes';\nimport {TuiHintDirective} from '@taiga-ui/core/directives/hint';\nimport type {TuiPoint} from '@taiga-ui/core/types';\n\n@Directive({\n    standalone: true,\n    selector: '[tuiLineClampPosition]',\n    providers: [tuiAsPositionAccessor(TuiLineClampPositionDirective)],\n})\nexport class TuiLineClampPositionDirective extends TuiPositionAccessor {\n    private readonly accessor = inject<TuiRectAccessor>(TuiHintDirective);\n    public readonly type = 'hint';\n\n    public getPosition(): TuiPoint {\n        const {top, left} = this.accessor.getClientRect();\n\n        return [top, left];\n    }\n}\n","import type {AfterViewInit, DoCheck} from '@angular/core';\nimport {\n    ChangeDetectionStrategy,\n    ChangeDetectorRef,\n    Component,\n    ElementRef,\n    inject,\n    Input,\n    Output,\n    signal,\n    ViewChild,\n} from '@angular/core';\nimport {takeUntilDestroyed, toSignal} from '@angular/core/rxjs-interop';\nimport {tuiTypedFromEvent} from '@taiga-ui/cdk/observables';\nimport {tuiInjectElement, tuiIsCurrentTarget} from '@taiga-ui/cdk/utils/dom';\nimport {\n    TUI_HINT_COMPONENT,\n    TuiHint,\n    TuiHintDirective,\n} from '@taiga-ui/core/directives/hint';\nimport type {PolymorpheusContent} from '@taiga-ui/polymorpheus';\nimport {PolymorpheusOutlet} from '@taiga-ui/polymorpheus';\nimport type {Observable} from 'rxjs';\nimport {\n    BehaviorSubject,\n    debounceTime,\n    distinctUntilChanged,\n    filter,\n    map,\n    of,\n    pairwise,\n    startWith,\n    Subject,\n    switchMap,\n} from 'rxjs';\n\nimport {TUI_LINE_CLAMP_OPTIONS} from './line-clamp.options';\nimport {TuiLineClampBox} from './line-clamp-box.component';\nimport {TuiLineClampPositionDirective} from './line-clamp-position.directive';\n\n// 4px buffer for IE/Edge incorrectly rounding scrollHeight\nconst BUFFER = 4;\n\n@Component({\n    standalone: true,\n    selector: 'tui-line-clamp',\n    imports: [PolymorpheusOutlet, TuiHint, TuiLineClampPositionDirective],\n    templateUrl: './line-clamp.template.html',\n    styleUrls: ['./line-clamp.style.less'],\n    changeDetection: ChangeDetectionStrategy.OnPush,\n    providers: [\n        {\n            provide: TUI_HINT_COMPONENT,\n            useValue: TuiLineClampBox,\n        },\n    ],\n    host: {\n        '[style.height.px]': 'height()',\n        '[style.max-height.px]': 'maxHeight()',\n        '[class._initialized]': 'initialized()',\n        '(transitionend)': 'updateView()',\n        '(mouseenter)': 'updateView()',\n        '(resize)': 'updateView()',\n    },\n})\nexport class TuiLineClamp implements DoCheck, AfterViewInit {\n    @ViewChild(TuiHintDirective, {read: ElementRef})\n    private readonly outlet?: ElementRef<HTMLElement>;\n\n    private readonly options = inject(TUI_LINE_CLAMP_OPTIONS);\n    private readonly el = tuiInjectElement();\n    private readonly cd = inject(ChangeDetectorRef);\n    private readonly linesLimit$ = new BehaviorSubject(1);\n    private readonly isOverflown$ = new Subject<boolean>();\n    protected initialized = signal(false);\n    protected maxHeight = signal(0);\n    protected height = signal(0);\n\n    protected lineClamp = toSignal(\n        this.linesLimit$.pipe(\n            startWith(1),\n            pairwise(),\n            switchMap(([prev, next]) =>\n                next >= prev\n                    ? of(next)\n                    : tuiTypedFromEvent(this.el, 'transitionend').pipe(\n                          filter(tuiIsCurrentTarget),\n                          map(() => next),\n                      ),\n            ),\n            takeUntilDestroyed(),\n        ),\n        {initialValue: 0},\n    );\n\n    @Input()\n    public lineHeight = 24;\n\n    @Input()\n    public content: PolymorpheusContent;\n\n    @Output()\n    public readonly overflownChange: Observable<boolean> = this.isOverflown$.pipe(\n        debounceTime(0),\n        distinctUntilChanged(),\n    );\n\n    @Input()\n    public set linesLimit(linesLimit: number) {\n        this.linesLimit$.next(linesLimit);\n    }\n\n    public ngDoCheck(): void {\n        this.update();\n        this.isOverflown$.next(this.overflown);\n    }\n\n    public ngAfterViewInit(): void {\n        this.initialized.set(true);\n    }\n\n    protected get overflown(): boolean {\n        if (!this.outlet) {\n            return false;\n        }\n\n        const {\n            scrollHeight,\n            scrollWidth,\n            clientHeight: outletHeight,\n        } = this.outlet.nativeElement;\n        const {clientHeight, clientWidth} = this.el;\n\n        return (\n            scrollHeight - clientHeight > BUFFER ||\n            scrollWidth - clientWidth > 0 ||\n            scrollHeight > outletHeight\n        );\n    }\n\n    protected get computedContent(): PolymorpheusContent {\n        return this.options.showHint && this.overflown ? this.content : '';\n    }\n\n    protected updateView(): void {\n        this.cd.detectChanges();\n    }\n\n    private update(): void {\n        if (this.outlet) {\n            this.height.set(this.outlet.nativeElement.scrollHeight + BUFFER);\n        }\n\n        this.maxHeight.set(this.lineHeight * this.linesLimit$.value);\n    }\n}\n","<div\n    tuiLineClampPosition\n    class=\"t-wrapper\"\n    [style.-webkit-line-clamp]=\"lineClamp()\"\n    [style.word-break]=\"lineClamp() > 1 ? 'break-word' : 'break-all'\"\n    [tuiHint]=\"computedContent\"\n>\n    <ng-container *polymorpheusOutlet=\"content as text\">\n        {{ text }}\n    </ng-container>\n</div>\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './index';\n"],"names":[],"mappings":"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"}